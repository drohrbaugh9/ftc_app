#!/usr/bin/perl

use Getopt::Std;
 
# declare the perl command line flags/options we want to allow
my %options=();
getopts("h:l:", \%options);
 
$length = $options{l} if defined $options{l};
$sets = 0;
while (<>)
{
  @fields = split;
  if ($fields[0] eq "DATA_SET_NAME")
  {
    $header = $fields[1];
    $count = 0;
  }
  else
  {
    $data[$sets][$count++] = $fields[0];
    if ($count == $length)
    {
      $sets++;
    }
  }
}

$header =~ s/_.$/_ave/;
$header = $options{h} if defined $options{h};
print "DATA_SET_NAME $header\n";

for ($i=0;$i<$length;$i++)
{
  $sum = 0;
  for ($j=0;$j<$sets;$j++)
  {
    $sum = $sum + $data[$j][$i];
  }
  printf("%6.2f\n",$sum/$sets);
}

